[build]
  command = "npm run build"
  publish = ".next"

[build.environment]
  NODE_VERSION = "18"

[[plugins]]
  package = "@netlify/plugin-nextjs"

[functions]
  directory = "netlify/functions"

# Scheduled function: Process pending calls every 5 minutes (9 AM - 7 PM EST, Mon-Fri)
# Note: Netlify Scheduled Functions require Pro plan or above for custom schedules
# This runs every 5 minutes - the function itself checks if it's within calling hours
[functions."process-calls"]
  schedule = "*/5 * * * *"

# Scheduled function: Recover calls that missed webhook processing
# Fetches transcripts and audio for calls with conversation_id but no transcript
# Runs every 15 minutes
[functions."recover-calls"]
  schedule = "*/15 * * * *"
